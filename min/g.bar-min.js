/*!
 * g.Raphael 0.5 - Charting library, based on RaphaÃ«l
 *
 * Copyright (c) 2009 Dmitry Baranovskiy (http://g.raphaeljs.com)
 * Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
 */
(function(){var f=Math.min,a=Math.max;function e(o,m,h,p,j,k,l,i){var s,n={round:"round",sharp:"sharp",soft:"soft",square:"square"};if((j&&!p)||(!j&&!h)){return l?"":i.path()}k=n[k]||"square";p=Math.round(p);h=Math.round(h);o=Math.round(o);m=Math.round(m);switch(k){case"round":if(!j){var g=~~(p/2);if(h<g){g=h;s=["M",o+0.5,m+0.5-~~(p/2),"l",0,0,"a",g,~~(p/2),0,0,1,0,p,"l",0,0,"z"]}else{s=["M",o+0.5,m+0.5-g,"l",h-g,0,"a",g,g,0,1,1,0,p,"l",g-h,0,"z"]}}else{g=~~(h/2);if(p<g){g=p;s=["M",o-~~(h/2),m,"l",0,0,"a",~~(h/2),g,0,0,1,h,0,"l",0,0,"z"]}else{s=["M",o-g,m,"l",0,g-p,"a",g,g,0,1,1,h,0,"l",0,p-g,"z"]}}break;case"sharp":if(!j){var q=~~(p/2);s=["M",o,m+q,"l",0,-p,a(h-q,0),0,f(q,h),q,-f(q,h),q+(q*2<p),"z"]}else{q=~~(h/2);s=["M",o+q,m,"l",-h,0,0,-a(p-q,0),q,-f(q,p),q,f(q,p),q,"z"]}break;case"square":if(!j){s=["M",o,m+~~(p/2),"l",0,-p,h,0,0,p,"z"]}else{s=["M",o+~~(h/2),m,"l",1-h,0,0,-p,h-1,0,"z"]}break;case"soft":if(!j){g=f(h,Math.round(p/5));s=["M",o+0.5,m+0.5-~~(p/2),"l",h-g,0,"a",g,g,0,0,1,g,g,"l",0,p-g*2,"a",g,g,0,0,1,-g,g,"l",g-h,0,"z"]}else{g=f(Math.round(h/5),p);s=["M",o-~~(h/2),m,"l",0,g-p,"a",g,g,0,0,1,g,-g,"l",h-2*g,0,"a",g,g,0,0,1,g,g,"l",0,p-g,"z"]}}if(l){return s.join(",")}else{return i.path(s)}}function d(l,K,I,g,m,aa,E){E=E||{};var A=this,ab=E.type||"square",u=parseFloat(E.gutter||"20%"),W=l.set(),F=l.set(),n=l.set(),C=l.set(),G=Math.max.apply(Math,aa),V=Math.min.apply(Math,aa),Z=[],J=0,O=E.colors||A.colors,B=aa.length;if(Raphael.is(aa[0],"array")){G=[];V=[];J=B;B=0;for(var T=aa.length;T--;){F.push(l.set());G.push(Math.max.apply(Math,aa[T]));V.push(Math.min.apply(Math,aa[T]));B=Math.max(B,aa[T].length)}if(E.stacked){for(var T=B;T--;){var r=0;for(var S=aa.length;S--;){r+=+aa[S][T]||0}Z.push(r)}}for(var T=aa.length;T--;){if(aa[T].length<B){for(var S=B;S--;){aa[T].push(0)}}}G=Math.max.apply(Math,E.stacked?Z:G);V=Math.min.apply(Math,E.stacked?Z:V)}G=(Math.abs(V)>G?Math.abs(V):G);G=(E.to)||G;var M=g/(B*(100+u)+u)*100,k=M*u/100,p=E.vgutter==null?20:E.vgutter,D=[],q=K+k,o=(m-2*p)/G;if(!E.stretch){k=Math.round(k);M=Math.floor(M)}!E.stacked&&(M/=J||1);for(var T=0;T<B;T++){D=[];for(var S=0;S<(J||1);S++){var L=(J?aa[S][T]:aa[T]),U=Math.round(Math.abs(L)*o),t=I+m-p-U,Q=e(Math.round(q+M/2),t+U,M,U,true,ab,null,l).attr({stroke:"none",fill:O[J?S:T]});if(L<0){Q.rotate(180,q+M/2,t+U)}if(J){F[S].push(Q)}else{F.push(Q)}Q.y=t;Q.x=Math.round(q+M/2);Q.w=M;Q.h=U;Q.value=J?aa[S][T]:aa[T];if(!E.stacked){q+=M}else{D.push(Q)}}if(E.stacked){var R;C.push(R=l.rect(D[0].x-D[0].w/2,I,M,m).attr(A.shim));R.bars=l.set();var w=0;for(var N=D.length;N--;){D[N].toFront()}for(var N=0,z=D.length;N<z;N++){var Q=D[N],H,U=(w+Q.value)*o,P=e(Q.x,I+m-p-!!w*0.5,M,U,true,ab,1,l);R.bars.push(Q);w&&Q.attr({path:P});Q.h=U;Q.y=I+m-p-!!w*0.5-U;n.push(H=l.rect(Q.x-Q.w/2,Q.y,M,Q.value*o).attr(A.shim));H.bar=Q;H.value=Q.value;w+=Q.value}q+=M}q+=k}C.toFront();q=K+k;if(!E.stacked){for(var T=0;T<B;T++){for(var S=0;S<(J||1);S++){var H;n.push(H=l.rect(Math.round(q),I+p,M,m-p).attr(A.shim));H.bar=J?F[S][T]:F[T];H.value=H.bar.value;q+=M}q+=k}}W.label=function(x,Y){x=x||[];this.labels=l.set();var ac,h=-Infinity;if(E.stacked){for(var v=0;v<B;v++){var y=0;for(var s=0;s<(J||1);s++){y+=J?aa[s][v]:aa[v];if(s==J-1){var ad=l.labelise(x[v],y,G);ac=l.text(F[v*(J||1)+s].x,I+m-p/2,ad).attr(txtattr).insertBefore(n[v*(J||1)+s]);var X=ac.getBBox();if(X.x-7<h){ac.remove()}else{this.labels.push(ac);h=X.x+X.width}}}}}else{for(var v=0;v<B;v++){for(var s=0;s<(J||1);s++){var ad=l.labelise(J?x[s]&&x[s][v]:x[v],J?aa[s][v]:aa[v],G);ac=l.text(F[v*(J||1)+s].x,Y?I+m-p/2:F[v*(J||1)+s].y-10,ad).attr(txtattr).insertBefore(n[v*(J||1)+s]);var X=ac.getBBox();if(X.x-7<h){ac.remove()}else{this.labels.push(ac);h=X.x+X.width}}}}return this};W.hover=function(i,h){C.hide();n.show();n.mouseover(i).mouseout(h);return this};W.hoverColumn=function(i,h){n.hide();C.show();h=h||function(){};C.mouseover(i).mouseout(h);return this};W.click=function(h){C.hide();n.show();n.click(h);return this};W.each=function(j){if(!Raphael.is(j,"function")){return this}for(var h=n.length;h--;){j.call(n[h])}return this};W.eachColumn=function(j){if(!Raphael.is(j,"function")){return this}for(var h=C.length;h--;){j.call(C[h])}return this};W.clickColumn=function(h){n.hide();C.show();C.click(h);return this};W.push(F,n,C);W.bars=F;W.covers=n;return W}function b(w,v,u,I,F,l,B){B=B||{};var h=this,n=B.type||"square",o=parseFloat(B.gutter||"20%"),D=w.set(),H=w.set(),q=w.set(),L=w.set(),T=Math.max.apply(Math,l),g=[],J=0,t=B.colors||h.colors,O=l.length;if(Raphael.is(l[0],"array")){T=[];J=O;O=0;for(var N=l.length;N--;){H.push(w.set());T.push(Math.max.apply(Math,l[N]));O=Math.max(O,l[N].length)}if(B.stacked){for(var N=O;N--;){var z=0;for(var M=l.length;M--;){z+=+l[M][N]||0}g.push(z)}}for(var N=l.length;N--;){if(l[N].length<O){for(var M=O;M--;){l[N].push(0)}}}T=Math.max.apply(Math,B.stacked?g:T)}T=(B.to)||T;var Q=Math.floor(F/(O*(100+o)+o)*100),r=Math.floor(Q*o/100),p=[],k=u+r,m=(I-1)/T;!B.stacked&&(Q/=J||1);for(var N=0;N<O;N++){p=[];for(var M=0;M<(J||1);M++){var S=J?l[M][N]:l[N],P=e(v,k+Q/2,Math.round(S*m),Q-1,false,n,null,w).attr({stroke:"none",fill:t[J?M:N]});if(J){H[M].push(P)}else{H.push(P)}P.x=v+Math.round(S*m);P.y=k+Q/2;P.w=Math.round(S*m);P.h=Q;P.value=+S;if(!B.stacked){k+=Q}else{p.push(P)}}if(B.stacked){var A=w.rect(v,p[0].y-p[0].h/2,I,Q).attr(h.shim);L.push(A);A.bars=w.set();var E=0;for(var C=p.length;C--;){p[C].toFront()}for(var C=0,K=p.length;C<K;C++){var P=p[C],R,S=Math.round((E+P.value)*m),G=e(v,P.y,S,Q-1,false,n,1,w);A.bars.push(P);E&&P.attr({path:G});P.w=S;P.x=v+S;q.push(R=w.rect(v+E*m,P.y-P.h/2,P.value*m,Q).attr(h.shim));R.bar=P;E+=P.value}k+=Q}k+=r}L.toFront();k=u+r;if(!B.stacked){for(var N=0;N<O;N++){for(var M=0;M<(J||1);M++){var R=w.rect(v,k,I,Q).attr(h.shim);q.push(R);R.bar=J?H[M][N]:H[N];R.value=R.bar.value;k+=Q}k+=r}}D.label=function(Z,W){Z=Z||[];this.labels=w.set();for(var V=0;V<O;V++){for(var U=0;U<J;U++){var y=w.labelise(J?Z[U]&&Z[U][V]:Z[V],J?l[U][V]:l[V],T),Y=W?H[V*(J||1)+U].x-Q/2+3:v+5,x=W?"end":"start",s;this.labels.push(s=w.text(Y,H[V*(J||1)+U].y,y).attr(txtattr).attr({"text-anchor":x}).insertBefore(q[0]));if(s.getBBox().x<v+5){s.attr({x:v+5,"text-anchor":"start"})}else{H[V*(J||1)+U].label=s}}}return this};D.hover=function(j,i){L.hide();q.show();i=i||function(){};q.mouseover(j).mouseout(i);return this};D.hoverColumn=function(j,i){q.hide();L.show();i=i||function(){};L.mouseover(j).mouseout(i);return this};D.each=function(s){if(!Raphael.is(s,"function")){return this}for(var j=q.length;j--;){s.call(q[j])}return this};D.eachColumn=function(s){if(!Raphael.is(s,"function")){return this}for(var j=L.length;j--;){s.call(L[j])}return this};D.click=function(i){L.hide();q.show();q.click(i);return this};D.clickColumn=function(i){q.hide();L.show();L.click(i);return this};D.push(H,q,L);D.bars=H;D.covers=q;return D}var c=function(){};c.prototype=Raphael.g;b.prototype=d.prototype=new c;Raphael.fn.hbarchart=function(h,l,j,g,i,k){return new b(this,h,l,j,g,i,k)};Raphael.fn.barchart=function(h,l,j,g,i,k){return new d(this,h,l,j,g,i,k)}})();